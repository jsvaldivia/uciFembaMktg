Sub add_round()
Dim rng As Range
Dim wst As Range
    For Each rng In Selection
        If Not IsEmpty(rng.Value) Then
            If IsNumeric(rng.Formula) Then
                rng.Value = "=Round(" & Mid(rng.Formula, 1, 9999) & ",3)"
            ElseIf IsNumeric(rng.Value) Then
                Set wst = rng
                rng.Value = "=Round(" & Mid(rng.Formula, 2, 9999) & ",3)"
                Set rng = wst
            End If
        End If
    rng.NumberFormat = "0.000"
    Next rng
    
End Sub
